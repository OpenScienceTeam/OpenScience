{"version":2,"kind":"Notebook","sha256":"30c5605704867d90d35af59c438beae9278de89199c32dd78dc95bbe46192c1e","slug":"ch2-mof-advanced","location":"/MOF-book/ch2-mof-advanced.md","dependencies":[],"frontmatter":{"title":"第二章：MOF 吸附与模拟（进阶)!!","kernelspec":{"name":"jupyterbook","display_name":"jupyterbook"},"numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"ch2-mof-advanced.md","url":"/ch2-mof-advanced-bccb312ff3c1a716069f33ef225530f0.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"第二章：MOF 吸附与模拟（进阶）","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RNqsRorjRP"}],"identifier":"id-mof","label":"第二章：MOF 吸附与模拟（进阶）","html_id":"id-mof","implicit":true,"key":"jyuC0D1AVn"},{"type":"heading","depth":3,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2.1 吸附等温线基础","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LxLNaeocPj"}],"identifier":"id-2-1","label":"2.1 吸附等温线基础","html_id":"id-2-1","implicit":true,"key":"IHPGE32gau"},{"type":"paragraph","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"MOF 在气体储存、分离等应用中，","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wbK9WTCeWK"},{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"吸附等温线","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"NDCIHGcIP8"}],"key":"nSnp3YRn2O"},{"type":"text","value":"是非常重要的表征手段。","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"g9R8kVRvTW"}],"key":"TlSHGo6Q0j"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"典型的 Langmuir 等温线可写为：","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"IMd8GvfVhi"}],"key":"e1Ud6W69pM"},{"type":"math","value":"q(P) = q_{\\max} \\frac{b P}{1 + b P}","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>q</mi><mi>max</mi><mo>⁡</mo></msub><mfrac><mrow><mi>b</mi><mi>P</mi></mrow><mrow><mn>1</mn><mo>+</mo><mi>b</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">q(P) = q_{\\max} \\frac{b P}{1 + b P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1408em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"kuIxWPMW6b"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"其中：","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"LsDBUwmfRy"}],"key":"CGHMFzIr4e"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" q(P) ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\"> q(P) </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span></span></span></span>","key":"DqsaxjiR5O"},{"type":"text","value":"：在压力 ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"WlqkwN0ZsH"},{"type":"inlineMath","value":"P","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"pxp4rqWTPS"},{"type":"text","value":" 下的吸附量","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"SEKyVTC492"}],"key":"GWB3CTTiW1"}],"key":"vSvZJnIuSM"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" q_{\\max} ","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mi>max</mi><mo>⁡</mo></msub></mrow><annotation encoding=\"application/x-tex\"> q_{\\max} </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"V3iSKYQ5Ac"},{"type":"text","value":"：饱和吸附量","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"nhV3zZjX4m"}],"key":"seg9Rp74JS"}],"key":"GWM86vlCT9"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" b ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\"> b </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"ll2mG1AyoE"},{"type":"text","value":"：平衡常数（与温度有关）","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"zmveVh9cxL"}],"key":"tuEtropOyg"}],"key":"ogAovMvFHq"}],"key":"xvaVhPSzgX"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"Dc8WFT4AYz"}],"key":"HKDBRHDefZ"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"公式本身是简化模型，真实 MOF 吸附行为可能更复杂，如多位点吸附、微孔填充等。","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"WTeUuprE7U"}],"key":"PEBThKW3Qy"}],"key":"SMVjALe5fg"},{"type":"heading","depth":3,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"2.2 交互式曲线（使用 ipywidgets）","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"T77K3qwRaS"}],"identifier":"id-2-2-ipywidgets","label":"2.2 交互式曲线（使用 ipywidgets）","html_id":"id-2-2-ipywidgets","implicit":true,"key":"bQp36Q3qoc"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"下面示例展示如何在书中嵌入交互式控件（在支持的小环境中会成为交互式图像）。","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"LiT0Bu43Fx"}],"key":"gjeoE9GobD"}],"key":"kPzWhbgOBX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\ntry:\n    from ipywidgets import interact, FloatSlider\nexcept ImportError:\n    interact = None\n\ndef langmuir_isotherm(P, qmax, b):\n    return qmax * b * P / (1 + b * P)\n\ndef plot_langmuir(qmax=5.0, b=1.0):\n    P = np.linspace(0, 10, 200)\n    q = langmuir_isotherm(P, qmax, b)\n    plt.figure()\n    plt.plot(P, q)\n    plt.xlabel(\"压力 P (bar)\")\n    plt.ylabel(\"吸附量 q (mmol/g)\")\n    plt.title(f\"Langmuir 等温线 (qmax={qmax:.1f}, b={b:.2f})\")\n    plt.grid(True)\n    plt.show()\n\nif interact is not None:\n    interact(\n        plot_langmuir,\n        qmax=FloatSlider(min=1, max=10, step=0.5, value=5),\n        b=FloatSlider(min=0.1, max=5, step=0.1, value=1),\n    )\nelse:\n    # 如果没有 ipywidgets，就画一张默认图\n    plot_langmuir()","key":"s8Ytw5p4CE"},{"type":"output","id":"U_XTz55CHOg8tx77IN9aw","data":[{"output_type":"stream","name":"stderr","text":"/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 21560 (\\N{CJK UNIFIED IDEOGRAPH-5438}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 38468 (\\N{CJK UNIFIED IDEOGRAPH-9644}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 37327 (\\N{CJK UNIFIED IDEOGRAPH-91CF}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 31561 (\\N{CJK UNIFIED IDEOGRAPH-7B49}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 28201 (\\N{CJK UNIFIED IDEOGRAPH-6E29}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 32447 (\\N{CJK UNIFIED IDEOGRAPH-7EBF}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 21387 (\\N{CJK UNIFIED IDEOGRAPH-538B}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n/opt/anaconda3/envs/JB/lib/python3.11/site-packages/IPython/core/pylabtools.py:170: UserWarning: Glyph 21147 (\\N{CJK UNIFIED IDEOGRAPH-529B}) missing from font(s) DejaVu Sans.\n  fig.canvas.print_figure(bytes_io, **kw)\n"},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"7c21c2b615a6751e9ae8550ba4d88c6e","path":"/7c21c2b615a6751e9ae8550ba4d88c6e.png"}}}],"key":"JFJ06re1jS"}],"key":"xa8h1AfsfF"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"kjSf56zgDm"}],"key":"UAGLOGlS0l"},{"type":"paragraph","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"text","value":"要真正看到交互效果，需要在支持小部件渲染的环境中（例如 JupyterLab 或某些在线部署）。","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"SllZE9YDUL"}],"key":"l0ldGylalN"}],"key":"ohtcFirFts"},{"type":"heading","depth":3,"position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"2.3 动画示例（matplotlib animation）","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"xGv31qvHAx"}],"identifier":"id-2-3-matplotlib-animation","label":"2.3 动画示例（matplotlib animation）","html_id":"id-2-3-matplotlib-animation","implicit":true,"key":"eBQ5XwTc6k"},{"type":"paragraph","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"text","value":"下面是一个简单动画例子，模拟「气体分子进出 MOF 孔道」的示意（非常简化）。","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"WPofyeVUkC"}],"key":"caPJN0fjQf"}],"key":"MRVDnPYPZK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\nfrom matplotlib import animation\n\n# 创建一个简单的 2D 孔道示意 (正方形区域)\nfig, ax = plt.subplots()\nax.set_xlim(0, 1)\nax.set_ylim(0, 1)\nax.set_title(\"气体分子在 MOF 孔道中的随机运动（示意）\")\nax.set_xticks([])\nax.set_yticks([])\n\nn_particles = 10\npositions = np.random.rand(n_particles, 2)\nscat = ax.scatter(positions[:, 0], positions[:, 1])\n\ndef update(frame):\n    global positions\n    # 随机移动\n    step = 0.05 * (np.random.rand(n_particles, 2) - 0.5)\n    positions = positions + step\n    # 简单碰壁反射\n    positions = np.mod(positions, 1.0)\n    scat.set_offsets(positions)\n    return scat,\n\nani = animation.FuncAnimation(\n    fig, update, frames=100, interval=100, blit=True\n)\n\nplt.close(fig)  # 避免重复静态图\n\nfrom IPython.display import HTML\nHTML(ani.to_jshtml())","key":"N1rSxB7MZw"},{"type":"output","id":"KZgqjXoFge0oyNc-xsfwE","data":[{"output_type":"stream","name":"stderr","text":"/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 27668 (\\N{CJK UNIFIED IDEOGRAPH-6C14}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 20307 (\\N{CJK UNIFIED IDEOGRAPH-4F53}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 20998 (\\N{CJK UNIFIED IDEOGRAPH-5206}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 23376 (\\N{CJK UNIFIED IDEOGRAPH-5B50}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 22312 (\\N{CJK UNIFIED IDEOGRAPH-5728}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 23380 (\\N{CJK UNIFIED IDEOGRAPH-5B54}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 36947 (\\N{CJK UNIFIED IDEOGRAPH-9053}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 20013 (\\N{CJK UNIFIED IDEOGRAPH-4E2D}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 30340 (\\N{CJK UNIFIED IDEOGRAPH-7684}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 38543 (\\N{CJK UNIFIED IDEOGRAPH-968F}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 26426 (\\N{CJK UNIFIED IDEOGRAPH-673A}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 36816 (\\N{CJK UNIFIED IDEOGRAPH-8FD0}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 21160 (\\N{CJK UNIFIED IDEOGRAPH-52A8}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 65288 (\\N{FULLWIDTH LEFT PARENTHESIS}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 31034 (\\N{CJK UNIFIED IDEOGRAPH-793A}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 24847 (\\N{CJK UNIFIED IDEOGRAPH-610F}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:28: UserWarning: Glyph 65289 (\\N{FULLWIDTH RIGHT PARENTHESIS}) missing from font(s) DejaVu Sans.\n  ani = animation.FuncAnimation(\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 27668 (\\N{CJK UNIFIED IDEOGRAPH-6C14}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 20307 (\\N{CJK UNIFIED IDEOGRAPH-4F53}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 20998 (\\N{CJK UNIFIED IDEOGRAPH-5206}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 23376 (\\N{CJK UNIFIED IDEOGRAPH-5B50}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 22312 (\\N{CJK UNIFIED IDEOGRAPH-5728}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 23380 (\\N{CJK UNIFIED IDEOGRAPH-5B54}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 36947 (\\N{CJK UNIFIED IDEOGRAPH-9053}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 20013 (\\N{CJK UNIFIED IDEOGRAPH-4E2D}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 30340 (\\N{CJK UNIFIED IDEOGRAPH-7684}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 38543 (\\N{CJK UNIFIED IDEOGRAPH-968F}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 26426 (\\N{CJK UNIFIED IDEOGRAPH-673A}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 36816 (\\N{CJK UNIFIED IDEOGRAPH-8FD0}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 21160 (\\N{CJK UNIFIED IDEOGRAPH-52A8}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 65288 (\\N{FULLWIDTH LEFT PARENTHESIS}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 31034 (\\N{CJK UNIFIED IDEOGRAPH-793A}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 24847 (\\N{CJK UNIFIED IDEOGRAPH-610F}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n/var/folders/mr/9jwf1tfn6md34dct8v31rbpr0000gn/T/ipykernel_61488/4192419803.py:35: UserWarning: Glyph 65289 (\\N{FULLWIDTH RIGHT PARENTHESIS}) missing from font(s) DejaVu Sans.\n  HTML(ani.to_jshtml())\n"},{"output_type":"execute_result","execution_count":2,"metadata":{},"data":{"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"8c4ed1ad16fc1fb313708adbe39a99a5","path":"/8c4ed1ad16fc1fb313708adbe39a99a5.html"}}}],"key":"bRA1hdB2In"}],"key":"jelSXt3v9N"},{"type":"block","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"qPaQfvNXrN"}],"key":"GV5OKhDnFV"},{"type":"paragraph","position":{"start":{"line":122,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"在 HTML 输出中，这段代码将生成一个嵌入的 JS 动画。\n若构建时出错，检查你的环境是否安装了 matplotlib、ffmpeg 等依赖。","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"GcL8lJfE7C"}],"key":"IxOpJSfgA4"}],"key":"VsIzhqCvh4"},{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"2.4 Tabs 与折叠内容（MyST 扩展）","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"n0Iv1xyhuh"}],"identifier":"id-2-4-tabs-myst","label":"2.4 Tabs 与折叠内容（MyST 扩展）","html_id":"id-2-4-tabs-myst","implicit":true,"key":"CH9y8wZZUx"},{"type":"heading","depth":4,"position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"2.4.1 Tabs 示例","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"HCjzttwo2k"}],"identifier":"id-2-4-1-tabs","label":"2.4.1 Tabs 示例","html_id":"id-2-4-1-tabs","implicit":true,"key":"QNADmDdeVK"},{"type":"tabSet","children":[{"type":"tabItem","title":"吸附","children":[{"type":"paragraph","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"text","value":"吸附（adsorption）是气体或液体分子被「吸附到」固体表面或孔道中的过程。","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"ThzWtx73PQ"}],"key":"U9oivRePzX"}],"key":"cmGK4blj4I"},{"type":"tabItem","title":"解吸","children":[{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"解吸（desorption）是已经被吸附的分子从表面或孔道中离开的过程。","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"h9rfebwA4Y"}],"key":"tGqQqJ72Ud"}],"key":"YwZE5C2LVz"},{"type":"tabItem","title":"扩散","children":[{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"扩散（diffusion）描述了分子在 MOF 孔道中的迁移行为。","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"OIfi1YnRra"}],"key":"fov5L4aWu0"}],"key":"fDGwGArm9n"}],"key":"F5P5ieP5qr"},{"type":"heading","depth":4,"position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"2.4.2 折叠/下拉内容","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"OBP5aW2m75"}],"identifier":"id-2-4-2","label":"2.4.2 折叠/下拉内容","html_id":"id-2-4-2","implicit":true,"key":"qULPUBlVx1"},{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"GCMC 是模拟吸附过程的常用方法之一。","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"YMDmZnxwca"},{"type":"break","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"sOM3OyPu2g"},{"type":"text","value":"在给定温度 T、化学势 μ（或压力 P）条件下，体系粒子数 N 可以波动。\n通常用于模拟 MOF 对气体的吸附等温线。","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"PXZmdGvIRF"}],"key":"uk2Cy4lNx6"},{"type":"heading","depth":3,"position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"2.5 高级代码示例：简单 GCMC 风格的伪代码","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"FisWQP5X3D"}],"identifier":"id-2-5-gcmc","label":"2.5 高级代码示例：简单 GCMC 风格的伪代码","html_id":"id-2-5-gcmc","implicit":true,"key":"C4tb8px16m"}],"key":"Nj0F0A4EPp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import random\nimport math\n\ndef gcmc_step(N, mu, beta):\n    \"\"\"\n    非常简化的单步 GCMC 伪代码示意：\n    - 以概率 0.5 尝试插入粒子\n    - 否则尝试删除粒子\n    \"\"\"\n    if random.random() < 0.5:\n        # 尝试插入\n        dE = random.uniform(-1, 1)  # 假设的能量变化\n        acc = min(1, math.exp(-beta * dE + beta * mu))\n        move = \"insert\"\n    else:\n        # 尝试删除\n        if N == 0:\n            return N, \"skip\"\n        dE = random.uniform(-1, 1)\n        acc = min(1, math.exp(-beta * (-dE) - beta * mu))\n        move = \"delete\"\n\n    if random.random() < acc:\n        if move == \"insert\":\n            N += 1\n        elif move == \"delete\":\n            N -= 1\n        accepted = True\n    else:\n        accepted = False\n\n    return N, f\"{move}, accepted={accepted}\"\n\nN = 0\nmu = -2.0   # 化学势（示意）\nbeta = 1.0  # 1/(k_B T)（简化）\n\nfor step in range(10):\n    N, info = gcmc_step(N, mu, beta)\n    print(f\"Step {step:2d}: N={N}, {info}\")","key":"JWm5za3L2S"},{"type":"output","id":"qYC288RkbS4FzaVq1cNE9","data":[{"output_type":"stream","name":"stdout","text":"Step  0: N=0, skip\nStep  1: N=0, insert, accepted=False\nStep  2: N=0, insert, accepted=False\nStep  3: N=0, insert, accepted=False\nStep  4: N=1, insert, accepted=True\nStep  5: N=0, delete, accepted=True\nStep  6: N=1, insert, accepted=True\nStep  7: N=0, delete, accepted=True\nStep  8: N=0, skip\nStep  9: N=0, skip\n"}],"key":"f83zP1SWiz"}],"key":"JRd0htc2j1"},{"type":"block","children":[{"type":"heading","depth":3,"position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"2.6 内联公式、交叉引用与参考文献","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"B4PiXsw00Q"}],"identifier":"id-2-6","label":"2.6 内联公式、交叉引用与参考文献","html_id":"id-2-6","implicit":true,"key":"LK1lvOPHfp"},{"type":"paragraph","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"内联公式示例：Langmuir 模型中的平衡常数 (b) 与温度呈指数关系。","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"l7S8G1CbBE"}],"key":"NYbrVxYIKa"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"可引用上一章的图：见 {ref}fig-mof-schematic。\n也可以引用表格：见 {ref}tab-common-mofs。","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"AoT9J5pHhx"}],"key":"vs3zKWK0Id"},{"type":"paragraph","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"（如果你要加入真正的参考文献，可以再补充一个 references.bib，并在这儿使用 []{cite} 语法等。）","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"VgviAZyeJH"}],"key":"m1vaEvzRcK"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"⸻","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"W4FS3OXFd0"}],"key":"XmWPGNkt1N"},{"type":"heading","depth":3,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"2.7 小结","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"OGL7AaAmjy"}],"identifier":"id-2-7","label":"2.7 小结","html_id":"id-2-7","implicit":true,"key":"G1t3rij81t"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"本章通过 交互式曲线、动画、Tabs、下拉内容、进阶代码示例 等，展示了如何在 Jupyter Book 中构建一个较为丰富的 MOF 进阶章节。","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"Dk50j6ESiP"}],"key":"mCrYuPMvpZ"},{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"练习","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"SMMhTUBrSy"}],"key":"wVzOjQEdpS"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"尝试：","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"Vrv5FLrNsO"}],"key":"cj1AH4nD6k"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":214,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"将本章中的 Langmuir 等温线换成 Freundlich 或 Sips 模型；","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"qY2on85NCC"}],"key":"mSNoSsdRNZ"}],"key":"ndWOddh6uJ"},{"type":"listItem","spread":true,"position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"将动画改为 3D 轨迹；","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"kaDNeLGswZ"}],"key":"K9BOkS8Eyn"}],"key":"BBHtXDhlFi"},{"type":"listItem","spread":true,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"将 GCMC 伪代码替换为真正的能量评价（如 Lennard-Jones 势）。","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"dMd0Uy4qG8"}],"key":"OsSSSDBqch"}],"key":"PRm3rduABe"}],"key":"u5xkyt29FG"}],"key":"sIy0GfxP7m"}],"key":"AGpi4q8Csx"}],"key":"wdmaTSdyd2"},"references":{"cite":{"order":[],"data":{}}}}