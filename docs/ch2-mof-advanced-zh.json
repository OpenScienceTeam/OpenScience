{"version":3,"kind":"Notebook","sha256":"5b7519244d946054bb21ab589a6676da85366d8bc6b254d08e4f0a0acf3857f9","slug":"ch2-mof-advanced-zh","location":"/zh/ch2-mof-advanced-zh.md","dependencies":[],"frontmatter":{"title":"MOF书籍示例第二章（进阶）","kernelspec":{"name":"jupyterbook","display_name":"jupyterbook"},"authors":[{"id":"OpenScienceTeam","name":"OpenScienceTeam"}],"keywords":[],"numbering":{"title":{"offset":1}},"exports":[{"format":"md","filename":"ch2-mof-advanced-zh.md","url":"/build/ch2-mof-advanced-zh-461c904294a81e42f63a9c6a846ede09.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"第二章：MOF 吸附与模拟","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"COlvjwB3zG"}],"identifier":"id-mof","label":"第二章：MOF 吸附与模拟","html_id":"id-mof","implicit":true,"key":"QVHqxqAEu2"},{"type":"blockquote","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"本章为MOF简介进阶章节，显示更多可以使用的功能和交互式代码","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"G4lx9k2pkh"}],"key":"jVXW30XiAk"}],"key":"bhha88GOOQ"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"2.1 吸附等温线基础","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"wFJ5mUrJlW"}],"identifier":"id-2-1","label":"2.1 吸附等温线基础","html_id":"id-2-1","implicit":true,"key":"m4sdjKXIrm"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"MOF 在气体储存、分离等应用中，","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"NqNholCkUS"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"吸附等温线","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rUkqCZjvD9"}],"key":"G9E6bDpQ2k"},{"type":"text","value":"是非常重要的表征手段。","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"xq17ZnBE2w"}],"key":"bH1nCNZT7K"},{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"典型的 Langmuir 等温线可写为：","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"xoan3FN43V"}],"key":"XWyZN4vDLG"},{"type":"math","value":"q(P) = q_{\\max} \\frac{b P}{1 + b P}","position":{"start":{"line":19,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>q</mi><mi>max</mi><mo>⁡</mo></msub><mfrac><mrow><mi>b</mi><mi>P</mi></mrow><mrow><mn>1</mn><mo>+</mo><mi>b</mi><mi>P</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">q(P) = q_{\\max} \\frac{b P}{1 + b P}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1408em;vertical-align:-0.7693em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"D1UT4dqz2W"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"其中：","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"NAIL6KuCFB"}],"key":"OFUBBfdUGh"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":25,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" q(P) ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>q</mi><mo stretchy=\"false\">(</mo><mi>P</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\"> q(P) </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mclose\">)</span></span></span></span>","key":"lIH2Cy0oAW"},{"type":"text","value":"：在压力 ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"RnkF82P5Qu"},{"type":"inlineMath","value":"P","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"cpI47yH6pt"},{"type":"text","value":" 下的吸附量","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"TFjGHY23Pj"}],"key":"WGOt6KkQPP"}],"key":"cdC0zQZBuL"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" q_{\\max} ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>q</mi><mi>max</mi><mo>⁡</mo></msub></mrow><annotation encoding=\"application/x-tex\"> q_{\\max} </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">q</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mop mtight\"><span class=\"mtight\">m</span><span class=\"mtight\">a</span><span class=\"mtight\">x</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"w6tFm44K6s"},{"type":"text","value":"：饱和吸附量","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"s6UHZemO9E"}],"key":"lAheq1dHDV"}],"key":"NnRA0p9glH"},{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":" b ","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\"> b </annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"CrLy9fh0IK"},{"type":"text","value":"：平衡常数（与温度有关）","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"do6W4bI3B7"}],"key":"rsXSqy0vGr"}],"key":"eKZvG3Yb0R"}],"key":"cTbWGKU7Fy"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"CbOuLSeIOL"}],"key":"klXHi9i6DI"},{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"公式本身是简化模型，真实 MOF 吸附行为可能更复杂，如多位点吸附、微孔填充等。","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"UXWQcs2sK9"}],"key":"QVRAbPgDYc"}],"key":"aLNrvmw1gL"},{"type":"thematicBreak","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"ua4VGZ5kqj"},{"type":"heading","depth":3,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"2.2 MOF 吸附等温线可视化","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"foqih9NajH"}],"identifier":"id-2-2-mof","label":"2.2 MOF 吸附等温线可视化","html_id":"id-2-2-mof","implicit":true,"key":"rog1m30qul"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"不同的MOF拥有不同的吸附性能，比如","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"nnm4zqUnmp"},{"type":"link","url":"./ch1-mof-basics#target-struct","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"第一章的1.2 典型结构示意与晶胞","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"lxa3oxHRjt"}],"urlSource":"./ch1-mof-basics#target-struct","key":"sT45YhoGID"},{"type":"text","value":"中示例的MOF结构。","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"lDogdCOW5q"}],"key":"lY3oVOR9hb"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"下面示例展示不同 MOF 材料的吸附等温线特性。我们使用 Langmuir 模型来模拟典型的 MOF 吸附行为。","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"K3M6CcpnxW"}],"key":"SKRHbpLBZ5"}],"key":"NhxZOFBXDc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Define Langmuir isotherm function\ndef langmuir_isotherm(P, qmax, b):\n    \"\"\"\n    Langmuir isotherm model\n    P: Pressure (bar)\n    qmax: Saturation uptake (mmol/g)\n    b: Equilibrium constant (bar^-1)\n    \"\"\"\n    return qmax * b * P / (1 + b * P)\n\n# Parameters for different MOFs (based on literature data)\nmof_params = {\n    'MOF-5': {'qmax': 8.5, 'b': 0.5, 'color': 'blue'},\n    'UiO-66': {'qmax': 6.2, 'b': 0.8, 'color': 'green'},\n    'HKUST-1': {'qmax': 7.8, 'b': 0.6, 'color': 'red'},\n    'MIL-101(Cr)': {'qmax': 9.5, 'b': 0.4, 'color': 'orange'}\n}\n\n# Generate pressure range\nP = np.linspace(0, 10, 200)\n\n# Plot multiple isotherms\nplt.figure(figsize=(10, 6))\nfor name, params in mof_params.items():\n    q = langmuir_isotherm(P, params['qmax'], params['b'])\n    plt.plot(P, q, label=name, color=params['color'], linewidth=2)\n\nplt.xlabel(\"Pressure P (bar)\", fontsize=12)\nplt.ylabel(\"Uptake q (mmol/g)\", fontsize=12)\nplt.title(\"CO₂ Adsorption Isotherms for Different MOFs (Langmuir Model)\", fontsize=14)\nplt.legend(fontsize=10)\nplt.grid(True, alpha=0.3)\nplt.xlim(0, 10)\nplt.ylim(0, 10)\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"k3PfnGHOFQ"},{"type":"outputs","id":"Xo0ZNHa9cHtPrkO6rbhsN","children":[],"visibility":"show","key":"bV9K3XPukz"}],"data":{"tags":[]},"visibility":"show","key":"SKWrRW1UMU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Relationship between MOF porosity and surface area (empirical fit)\n# Typical MOF porosity range: 0.3 - 0.9\nphi = np.linspace(0.3, 0.9, 13)\n\n# Empirical relation between surface area and porosity (simplified model)\n# Most MOFs have specific surface area in the range 1000-7000 m²/g\nsurface_area = 2000 + 5000 * phi  # simplified linear relationship\n\n# Representative MOF data points\nmof_data = {\n    'MOF-5': {'phi': 0.55, 'sa': 3800},\n    'UiO-66': {'phi': 0.65, 'sa': 1187},\n    'HKUST-1': {'phi': 0.68, 'sa': 1500},\n    'MIL-101(Cr)': {'phi': 0.78, 'sa': 4230},\n    'NU-1000': {'phi': 0.82, 'sa': 6143}\n}\n\nplt.figure(figsize=(8, 6))\nplt.plot(phi, surface_area, 'b--', linewidth=2, label='Empirical Relation', alpha=0.7)\n\n# Plot MOF data points\nfor name, data in mof_data.items():\n    plt.scatter(data['phi'], data['sa'], s=100, alpha=0.7, \n                label=name, edgecolors='black', linewidth=1.5)\n\nplt.xlabel(\"Porosity φ\", fontsize=12)\nplt.ylabel(\"Surface Area (m²/g)\", fontsize=12)\nplt.title(\"Relationship between MOF Porosity and Surface Area\", fontsize=14)\nplt.legend(fontsize=9, loc='upper left')\nplt.grid(True, alpha=0.3)\nplt.xlim(0.25, 0.95)\nplt.ylim(0, 7000)\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"i6m1gDlToH"},{"type":"outputs","id":"wMAu5YQ8tsd4gUCfHOPID","children":[],"visibility":"show","key":"aBtQ1W939r"}],"data":{"tags":[]},"visibility":"show","key":"qGgfX9mDaS"},{"type":"block","children":[{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"gkqhyqewaE"}],"key":"ndPaxKxxCS"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"上述图表展示了不同 MOF 材料的吸附特性。Langmuir 模型是简化模型，实际 MOF 的吸附行为可能更复杂，包括多位点吸附、微孔填充等机制。","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"YnBelqdDmI"}],"key":"cmtHxWGkiQ"}],"key":"UL21YcZzIy"},{"type":"thematicBreak","position":{"start":{"line":131,"column":1},"end":{"line":131,"column":1}},"key":"ADFuG0fi4s"},{"type":"heading","depth":3,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"2.3 MOF 孔道中气体分子的扩散模拟","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"HRdxpcDGiz"}],"identifier":"id-2-3-mof","label":"2.3 MOF 孔道中气体分子的扩散模拟","html_id":"id-2-3-mof","implicit":true,"key":"EDIkolSXZl"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"下面展示一个静态可视化示例，模拟气体分子在 MOF 孔道中的分布和扩散行为。我们使用随机游走模型来模拟分子在不同时间步的分布。","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"VKROtFfjWL"}],"key":"xATuUuuJ8t"}],"key":"R5OYUldML0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Rectangle\n\n# Simulation parameters\nnp.random.seed(42)  # For reproducibility\nn_particles = 50\nn_steps = 100\nbox_size = 1.0\n\n# Initialize: all molecules at center region\ninitial_positions = np.random.normal(0.5, 0.1, (n_particles, 2))\ninitial_positions = np.clip(initial_positions, 0.1, 0.9)\n\n# Diffusion process (random walk)\npositions = initial_positions.copy()\nfor step in range(n_steps):\n    # Random step (related to diffusion coefficient)\n    step_size = 0.02\n    random_steps = np.random.normal(0, step_size, (n_particles, 2))\n    positions += random_steps\n    # Reflective boundary\n    positions = np.clip(positions, 0.05, 0.95)\n\n# Visualization\nfig, axes = plt.subplots(1, 2, figsize=(14, 6))\n\n# Left: initial distribution\nax1 = axes[0]\nax1.scatter(initial_positions[:, 0], initial_positions[:, 1], \n           c='blue', s=50, alpha=0.6, edgecolors='black', linewidth=0.5)\nax1.add_patch(Rectangle((0.1, 0.1), 0.8, 0.8, fill=False, \n                        edgecolor='gray', linewidth=2, linestyle='--'))\nax1.set_xlim(0, 1)\nax1.set_ylim(0, 1)\nax1.set_aspect('equal')\nax1.set_title(\"Initial: Molecules Clustered in Center Region\", fontsize=12)\nax1.set_xlabel(\"Channel Position X\", fontsize=10)\nax1.set_ylabel(\"Channel Position Y\", fontsize=10)\nax1.grid(True, alpha=0.3)\n\n# Right: after diffusion\nax2 = axes[1]\nax2.scatter(positions[:, 0], positions[:, 1], \n           c='red', s=50, alpha=0.6, edgecolors='black', linewidth=0.5)\nax2.add_patch(Rectangle((0.1, 0.1), 0.8, 0.8, fill=False, \n                        edgecolor='gray', linewidth=2, linestyle='--'))\nax2.set_xlim(0, 1)\nax2.set_ylim(0, 1)\nax2.set_aspect('equal')\nax2.set_title(f\"After Diffusion ({n_steps} Steps): Molecules Evenly Spread\", fontsize=12)\nax2.set_xlabel(\"Channel Position X\", fontsize=10)\nax2.set_ylabel(\"Channel Position Y\", fontsize=10)\nax2.grid(True, alpha=0.3)\n\nplt.suptitle(\"Simulation of Gas Molecule Diffusion in MOF Channel\", fontsize=14, y=1.02)\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"tqLppmYOgk"},{"type":"outputs","id":"2yHnQUpGRzm6i0g-uBnJe","children":[],"visibility":"show","key":"cJVCBob1E8"}],"data":{"tags":[]},"visibility":"show","key":"Vdv1USZ9GC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\n# Simulate molecular density distribution at different time steps\nnp.random.seed(42)\nn_particles = 100\ntime_steps = [0, 20, 50, 100]\nbox_size = 1.0\n\nfig, axes = plt.subplots(2, 2, figsize=(12, 12))\naxes = axes.flatten()\n\ninitial_positions = np.random.normal(0.5, 0.1, (n_particles, 2))\ninitial_positions = np.clip(initial_positions, 0.1, 0.9)\n\nfor idx, n_steps in enumerate(time_steps):\n    ax = axes[idx]\n    positions = initial_positions.copy()\n    \n    for step in range(n_steps):\n        step_size = 0.02\n        random_steps = np.random.normal(0, step_size, (n_particles, 2))\n        positions += random_steps\n        positions = np.clip(positions, 0.05, 0.95)\n    \n    # Use 2D histogram to show density\n    hist, xedges, yedges = np.histogram2d(positions[:, 0], positions[:, 1], \n                                          bins=20, range=[[0, 1], [0, 1]])\n    extent = [0, 1, 0, 1]\n    \n    im = ax.imshow(hist.T, origin='lower', extent=extent, \n                   cmap='YlOrRd', interpolation='bilinear', aspect='equal')\n    ax.add_patch(plt.Rectangle((0.1, 0.1), 0.8, 0.8, fill=False, \n                              edgecolor='black', linewidth=2))\n    ax.set_title(f\"Time Step t = {n_steps}\", fontsize=11)\n    ax.set_xlabel(\"Channel Position X\", fontsize=9)\n    ax.set_ylabel(\"Channel Position Y\", fontsize=9)\n    plt.colorbar(im, ax=ax, label='Molecule Density')\n\nplt.suptitle(\"Time Evolution of Molecular Density in MOF Channel\", fontsize=14, y=0.995)\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"tnqm31h0b4"},{"type":"outputs","id":"-s9GHmgbAPSzom0_eLu7B","children":[],"visibility":"show","key":"wWEi0OHPY6"}],"data":{"tags":[]},"visibility":"show","key":"wW21p6PiaL"},{"type":"block","children":[{"type":"admonition","kind":"tip","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Tip","key":"vbWRPpaTSl"}],"key":"r5Ni9g9JrK"},{"type":"paragraph","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"children":[{"type":"text","value":"上述可视化展示了气体分子在 MOF 孔道中的扩散过程。在实际应用中，可以使用更复杂的模型（如分子动力学模拟）来研究不同 MOF 结构的扩散特性。","position":{"start":{"line":248,"column":1},"end":{"line":248,"column":1}},"key":"hm3PY1goHO"}],"key":"ViS31gxaJF"}],"key":"jiFUYPWOHM"},{"type":"thematicBreak","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"FxHSNjlgF6"},{"type":"heading","depth":3,"position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"2.4 MOF 孔道中气体分子的行为定义","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"rEUiHnFOW2"}],"identifier":"id-2-4-mof","label":"2.4 MOF 孔道中气体分子的行为定义","html_id":"id-2-4-mof","implicit":true,"key":"rFQgtIGS7D"},{"type":"heading","depth":4,"position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"text","value":"2.4.1 不同分子行为定义","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"aZBauxXZiS"}],"identifier":"id-2-4-1","label":"2.4.1 不同分子行为定义","html_id":"id-2-4-1","implicit":true,"key":"YZkyGFkPkq"},{"type":"tabSet","children":[{"type":"tabItem","title":"吸附","children":[{"type":"paragraph","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"children":[{"type":"text","value":"吸附（adsorption）是气体或液体分子被「吸附到」固体表面或孔道中的过程。","position":{"start":{"line":259,"column":1},"end":{"line":259,"column":1}},"key":"dWk804UZCh"}],"key":"XilUCjuu8d"}],"key":"YjJqvmU3Pw"},{"type":"tabItem","title":"解吸","children":[{"type":"paragraph","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"解吸（desorption）是已经被吸附的分子从表面或孔道中离开的过程。","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"RfniS6TTIG"}],"key":"YOp1NWYP1p"}],"key":"LNBuCz5HPs"},{"type":"tabItem","title":"扩散","children":[{"type":"paragraph","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"children":[{"type":"text","value":"扩散（diffusion）描述了分子在 MOF 孔道中的迁移行为。","position":{"start":{"line":265,"column":1},"end":{"line":265,"column":1}},"key":"ZRYzrcMQ8B"}],"key":"NXnruIOPq9"}],"key":"c7ufCJW5L5"}],"key":"fevF5C5ddT"},{"type":"heading","depth":4,"position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"children":[{"type":"text","value":"2.4.2 模拟吸附过程简介","position":{"start":{"line":269,"column":1},"end":{"line":269,"column":1}},"key":"MzIO4fKDK6"}],"identifier":"id-2-4-2","label":"2.4.2 模拟吸附过程简介","html_id":"id-2-4-2","implicit":true,"key":"tANjr8Uwiy"},{"type":"details","children":[{"type":"summary","children":[{"type":"text","value":"GCMC 方法简介","position":{"start":{"line":271,"column":1},"end":{"line":271,"column":1}},"key":"G3SssEzwf2"}],"key":"hORJq9RNdk"},{"type":"paragraph","position":{"start":{"line":273,"column":1},"end":{"line":275,"column":1}},"children":[{"type":"text","value":"GCMC 是模拟吸附过程的常用方法之一。","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"HsBm2MAwZW"},{"type":"break","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"e5toDwHfVt"},{"type":"text","value":"在给定温度 ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"AcDLh8UvMp"},{"type":"inlineMath","value":"T","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>T</mi></mrow><annotation encoding=\"application/x-tex\">T</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span></span></span></span>","key":"BG17rkQWEH"},{"type":"text","value":"、化学势 ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"ao4FQbTIUG"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"DVFWUrbq35"},{"type":"text","value":"（或压力 ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"vRzy2ifcKw"},{"type":"inlineMath","value":"P","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>P</mi></mrow><annotation encoding=\"application/x-tex\">P</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span></span></span></span>","key":"ZLzAevvEXV"},{"type":"text","value":"）条件下，体系粒子数 ","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"KY4emvG2nS"},{"type":"inlineMath","value":"N","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"zySmrYAxHp"},{"type":"text","value":" 可以波动。","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"ldDBPprUXQ"},{"type":"break","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"TTi3hHmIH0"},{"type":"text","value":"通常用于模拟 MOF 对气体的吸附等温线。","position":{"start":{"line":273,"column":1},"end":{"line":273,"column":1}},"key":"JR49DrMk9C"}],"key":"z4MO2NvNXi"}],"key":"E0u7RCciuR"},{"type":"thematicBreak","position":{"start":{"line":279,"column":1},"end":{"line":279,"column":1}},"key":"XhsCTpQETQ"},{"type":"heading","depth":3,"position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"children":[{"type":"text","value":"2.5 简易 GCMC 模拟","position":{"start":{"line":281,"column":1},"end":{"line":281,"column":1}},"key":"ftL5xDIYvv"}],"identifier":"id-2-5-gcmc","label":"2.5 简易 GCMC 模拟","html_id":"id-2-5-gcmc","implicit":true,"key":"W2gvfahLP2"},{"type":"comment","value":"进阶代码示例","position":{"start":{"line":283,"column":1},"end":{"line":283,"column":1}},"key":"SwJQv9Vp6u"},{"type":"paragraph","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"children":[{"type":"text","value":"下面使用 Altair 实现一个可交互的 GCMC（大正则蒙特卡洛）模拟 MOF 吸附过程的可视化。你可以拖动化学势 ","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"UK4pDXeE0q"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"sK8OiSPAD1"},{"type":"text","value":" 的滑块，实时观察气体分子数均值的演化与分布。","position":{"start":{"line":285,"column":1},"end":{"line":285,"column":1}},"key":"IydtQbpPkB"}],"key":"Jd163VQhTW"}],"key":"gFaYz1CGrD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import altair as alt\nimport numpy as np\nimport pandas as pd\n\n# Simplified GCMC algorithm\ndef gcmc_sim(mu=-1.5, beta=1.0, V=100.0, n_steps=1000, seed=42):\n    np.random.seed(seed)\n    N = 0\n    N_list = []\n    for step in range(n_steps):\n        if np.random.rand() < 0.5:\n            # Insert\n            dE = 0.5 * N\n            acc = min(1, np.exp(-beta * dE + beta * mu + np.log(V/(N+1))))\n            if np.random.rand() < acc:\n                N += 1\n        else:\n            # Remove\n            if N > 0:\n                dE = 0.5 * (N-1)\n                acc = min(1, np.exp(-beta*(-dE) - beta*mu + np.log(N/V)))\n                if np.random.rand() < acc:\n                    N -= 1\n        N_list.append(N)\n    return N_list\n\n# Generate GCMC statistics for different μ values\n# Use ALL mu values that are multiples of 0.05 to match slider step exactly\n# This ensures slider can match ALL possible values (2.75, 2.8, 2.85, etc.)\nmu_list = np.arange(-3.0, 0.05, 0.05)  # -3.0, -2.95, -2.9, -2.85, ..., -0.05 (60 values)\n# All values are multiples of 0.05, matching slider step perfectly\nsteps = 300  # Reduced steps to keep total data size manageable\nresults = []\n\nfor mu in mu_list:\n    # Round to 2 decimal places to avoid floating point precision issues\n    mu_rounded = np.round(mu, 2)\n    N_hist = gcmc_sim(mu=mu_rounded, n_steps=steps)\n    # Downsample: take every 4th point to reduce data size (60 mu * 75 points = 4500 rows)\n    for i in range(0, len(N_hist), 4):\n        results.append({\n            'mu': mu_rounded,  # Use the rounded value\n            'Step': i,\n            'N': N_hist[i]\n        })\n\ndf = pd.DataFrame(results)\n\n# Mean adsorption statistics\ndf_mean = df.groupby('mu').agg(meanN=('N','mean'), stdN=('N','std')).reset_index()\n\n# Altair slider using param (Altair v5+)\nslider = alt.binding_range(min=-3, max=0, step=0.05, name='μ (chemical potential)=')\nmu_select = alt.param(\n    bind=slider,\n    value=-1.5\n)\n\n# 1. Evolution curve (top panel, full width)\n# Now mu values are exact multiples of 0.05, use small tolerance for matching\nline_evo = alt.Chart(df).mark_line(opacity=0.7, strokeWidth=2).encode(\n    x=alt.X('Step:Q', axis=alt.Axis(title='MC Step')),\n    y=alt.Y('N:Q', axis=alt.Axis(title='Number of molecules (N)')),\n    color=alt.Color('mu:O', legend=None),\n    tooltip=['Step', 'N', 'mu']\n).transform_filter(\n    # Use small tolerance (0.01) since data mu values are multiples of 0.05\n    # This will match when slider is within 0.01 of a data point\n    (alt.datum.mu >= mu_select - 0.01) & (alt.datum.mu <= mu_select + 0.01)\n).properties(\n    width=800, height=250,\n    title='GCMC Simulation: Evolution of N vs. MC Step'\n).add_params(mu_select)\n\n# 2. Adsorption isotherm\nads_iso = alt.Chart(df_mean).mark_line(interpolate='monotone', point=True).encode(\n    x=alt.X('mu:Q', axis=alt.Axis(title='Chemical potential μ', format='.2f')),\n    y=alt.Y('meanN:Q', axis=alt.Axis(title='Mean adsorbed molecules ⟨N⟩')),\n    tooltip=['mu','meanN','stdN'],\n    color=alt.value('#1367a7')\n).properties(\n    width=400, height=250,\n    title='MOF Adsorption Isotherm (GCMC Simulation)'\n)\n\nselected = ads_iso.mark_point(size=120, filled=True, color='crimson').encode(\n    x='mu:Q', y='meanN:Q'\n).transform_filter(\n    (alt.datum.mu >= mu_select - 0.01) & (alt.datum.mu <= mu_select + 0.01)\n)\n\n# 3. Histogram of N\nhist = alt.Chart(df).mark_bar(color='#E09842').encode(\n    x=alt.X('N:Q', bin=alt.Bin(maxbins=30), title='Number of molecules N'),\n    y=alt.Y('count():Q', title='Count'),\n    tooltip=['N','count()']\n).transform_filter(\n    (alt.datum.mu >= mu_select - 0.01) & (alt.datum.mu <= mu_select + 0.01)\n).properties(\n    width=400, height=250,\n    title='Distribution of N during MC'\n)\n\n# Combine panels: Evolution on top, Histogram and Isotherm side by side below\npanels = (\n    line_evo & (hist | (ads_iso + selected))\n).resolve_scale(y='independent')\n\n# Display the chart\npanels","visibility":"remove","key":"tlNPs45Hpi"},{"type":"outputs","id":"YEJrnxr7tXMVfH3T7Yq3B","children":[],"visibility":"show","key":"Fzo99euzis"}],"data":{"tags":[]},"visibility":"show","key":"UIhzXIZrW5"},{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"children":[{"type":"text","value":"你可以拖动「","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"VrrlTSRNXj"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"CijZNsNBfT"},{"type":"text","value":"（化学势）」滑块，在不同 ","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"URx7Q48I4i"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"HlLhyKjN7W"},{"type":"text","value":"（代表不同气体压力/浓度）下动态地观察：","position":{"start":{"line":402,"column":1},"end":{"line":402,"column":1}},"key":"FEhxdxXeQn"}],"key":"ZNtbaRx2s9"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":403,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"气体分子数随 MC 步数的变化趋势","position":{"start":{"line":403,"column":1},"end":{"line":403,"column":1}},"key":"aTsnslwLom"}],"key":"O0WZ4ApCz7"}],"key":"fupX7WOafj"},{"type":"listItem","spread":true,"position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"吸附均值 ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"CVRSNMwlfm"},{"type":"inlineMath","value":"\\langle N \\rangle","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">⟨</mo><mi>N</mi><mo stretchy=\"false\">⟩</mo></mrow><annotation encoding=\"application/x-tex\">\\langle N \\rangle</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">⟨</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">⟩</span></span></span></span>","key":"oJdl0yI5KC"},{"type":"text","value":" 随 ","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"kiQirCkvER"},{"type":"inlineMath","value":"\\mu","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>μ</mi></mrow><annotation encoding=\"application/x-tex\">\\mu</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">μ</span></span></span></span>","key":"yfF6CHzBRa"},{"type":"text","value":" 的变化（吸附等温线）","position":{"start":{"line":404,"column":1},"end":{"line":404,"column":1}},"key":"fQtSe6qSsP"}],"key":"HYFEUFaVVL"}],"key":"PrA4dxRasQ"},{"type":"listItem","spread":true,"position":{"start":{"line":405,"column":1},"end":{"line":406,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"MC 过程中 ","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"QlaXmIvvyZ"},{"type":"inlineMath","value":"N","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"ogF8P6ROxS"},{"type":"text","value":" 的分布直方图","position":{"start":{"line":405,"column":1},"end":{"line":405,"column":1}},"key":"ipMWv1qRJi"}],"key":"pm6Xubeu58"}],"key":"T6EskQ3Adh"}],"key":"IiohXsXMsf"},{"type":"paragraph","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"children":[{"type":"text","value":"本交互式可视化便于科研人员或学生直观理解和探索 MOF 吸附过程以及 GCMC 思路。","position":{"start":{"line":407,"column":1},"end":{"line":407,"column":1}},"key":"sZVQOfMT6v"}],"key":"gdHHkGc405"}],"key":"apwg0uvAzg"}],"key":"ssQUuZumAc"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"MOF书籍示例第一章（基础）","url":"/ch1-mof-basics-zh","group":"中文内容 (ZH)"}}},"domain":"http://localhost:3002"}